graph TD;
    A[Initial Foothold Gained]
    B[Identify Vulnerable Kernel Drivers]
    C[Craft Malicious Input for DeviceIoControl API]
    D[Send Input to Exploit Driver Vulnerability]
    E[Kernel Payload Execution Achieved]

    A -->|"Access gained via phishing attack Corporate Control: Email Gateway"| B
    A -->|"Deploy reconnaissance tools to enumerate installed drivers Corporate Control: Endpoint Protection Logs"| B
    A -->|"Monitor system activity for driver-related enumeration Corporate Control: EDR Systems"| B
    B -->|"Identify outdated or vulnerable drivers Corporate Control: Windows Driver Manager"| C
    B -->|"Analyze drivers for exploitable I/O control codes Corporate Control: Driver Documentation"| C
    B -->|"Monitor API interactions with kernel components Corporate Control: Endpoint Monitoring Tools"| C
    C -->|"Craft malicious input to exploit driver logic flaws Corporate Control: Exploit Development Environment"| D
    C -->|"Target vulnerable I/O control handlers in driver Corporate Control: Kernel I/O Interface"| D
    C -->|"Monitor driver activity for unauthorized access patterns Corporate Control: Behavioral Detection Systems"| D
    D -->|"Send malicious input to driver using DeviceIoControl API Corporate Control: Kernel API Layer"| E
    D -->|"Exploit driver vulnerability to execute kernel-mode payload Corporate Control: Kernel Memory"| E
    D -->|"Monitor for anomalies in driver execution paths Corporate Control: SIEM Systems"| E
    E -->|"Kernel payload execution grants attacker control Corporate Control: Target Kernel Environment"| D
    E -->|"Detect anomalies in kernel execution behavior Corporate Control: Endpoint Protection Logs"| D