graph TD;
    A[InitialAccess]
    B[PostAccessPreparation]
    C[PayloadDelivery]
    D[PreExecutionSetup]
    E[ExecutionAchieved]

    A -->|"Access gained via exposed API keys Corporate Control: IAM Audit Logs"| B
    A -->|"Enumerate permissions granted to serverless functions Corporate Control: Function Role Configurations"| B
    A -->|"Monitor for unauthorized API requests Corporate Control: SIEM Logs"| B
    A -->|"Detect excessive permissions in serverless functions Corporate Control: Cloud Security Logs"| B
    B -->|"Modify or create function using over-privileged roles Corporate Control: Function Source Code"| C
    B -->|"Focus on permissions granting access to high-value resources Corporate Control: IAM Policies"| C
    B -->|"Ensure malicious function mimics legitimate logic Corporate Control: Behavioral Analytics"| C
    B -->|"Monitor for unauthorized changes to IAM roles Corporate Control: File Integrity Monitoring"| C
    C -->|"Deploy function with payload targeting sensitive resources Corporate Control: Deployment Logs"| D
    C -->|"Ensure payload is obfuscated for stealth Corporate Control: Runtime Security Systems"| D
    C -->|"Monitor for unauthorized resource creation Corporate Control: Endpoint Protection Tools"| D
    D -->|"Trigger function execution leveraging excessive permissions Corporate Control: Execution Logs"| E
    D -->|"Detect anomalies in resource activity Corporate Control: Behavioral Analytics"| E
    D -->|"Payload successfully executed Corporate Control: Cloud Monitoring Systems"| E
