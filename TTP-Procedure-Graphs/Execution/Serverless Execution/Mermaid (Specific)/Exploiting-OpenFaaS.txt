graph TD;
    A[InitialAccess]
    B[PostAccessPreparation]
    C[PayloadDelivery]
    D[PreExecutionSetup]
    E[ExecutionAchieved]

    A -->|"Access gained via compromised API keys or open endpoints Corporate Control: OpenFaaS Gateway Logs"| B
    A -->|"Enumerate OpenFaaS functions for writable configurations Corporate Control: Function Configurations"| B
    A -->|"Monitor for excessive API activity targeting OpenFaaS endpoints Corporate Control: SIEM Logs"| B
    A -->|"Detect anomalies in API traffic Corporate Control: Behavioral Monitoring"| B
    B -->|"Modify function or create new function with malicious code Corporate Control: Function Deployment Files"| C
    B -->|"Configure triggers such as HTTP endpoints Corporate Control: OpenFaaS Event Triggers"| C
    B -->|"Ensure malicious logic mimics legitimate function activity Corporate Control: Function Monitoring Tools"| C
    B -->|"Monitor for unauthorized function updates Corporate Control: File Integrity Logs"| C
    C -->|"Deploy payload via HTTP POST or container registry Corporate Control: Function Deployment Logs"| D
    C -->|"Obfuscate payload for stealth Corporate Control: Runtime Protection Systems"| D
    C -->|"Monitor for unusual data inputs targeting functions Corporate Control: API Gateway Logs"| D
    D -->|"Trigger function execution via HTTP endpoint Corporate Control: OpenFaaS Execution Logs"| E
    D -->|"Detect anomalies in function runtime activity Corporate Control: Behavioral Analytics"| E
    D -->|"Payload executed successfully within OpenFaaS environment Corporate Control: Execution Logs"| E
