graph TD;
    A[InitialAccess]
    B[PostAccessPreparation]
    C[PayloadDelivery]
    D[PreExecutionSetup]
    E[ExecutionAchieved]

    A -->|"Access gained via brute-forcing RDP credentials Corporate Control: RDP Gateway"| B
    A -->|"Scan for applications configured to load DLLs from untrusted directories Corporate Control: Application Configuration Logs"| B
    A -->|"Monitor for unauthorized file enumeration Corporate Control: Endpoint Monitoring Systems"| B
    A -->|"Detect anomalies in endpoint activity during scans Corporate Control: SIEM Alerts"| B
    B -->|"Craft a malicious DLL with the same export functions as the expected shared module Corporate Control: Development Environment"| C
    B -->|"Test application behavior to identify exploitable search paths Corporate Control: File System Logs"| C
    B -->|"Ensure malicious DLL bypasses runtime file integrity checks Corporate Control: Endpoint Security Tools"| C
    B -->|"Monitor for unauthorized access to application configurations Corporate Control: Behavioral Analytics"| C
    C -->|"Place malicious DLL in a directory prioritized in the DLL search order Corporate Control: File System Monitoring"| D
    C -->|"Validate the application loads the malicious DLL during runtime Corporate Control: Application Logs"| D
    C -->|"Monitor for unexpected changes to DLL locations Corporate Control: File Integrity Monitoring"| D
    D -->|"Trigger application execution to load the malicious DLL Corporate Control: User Process Logs"| E
    D -->|"Detect anomalies in the applicationâ€™s execution Corporate Control: Behavioral Monitoring"| E
    D -->|"Malicious DLL executes, performing the intended payload Corporate Control: Application Execution Logs"| E
    D -->|"Monitor for unauthorized memory allocations in the process Corporate Control: Endpoint Detection Systems"| E
