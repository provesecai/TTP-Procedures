graph TD;
    A[Initial Foothold Gained]
    B[Prepare for API Server Exploitation]
    C[Send Malicious API Requests]
    D[Access Cluster Resources]
    E[Command Execution Achieved]

    A -->|"Access gained via stolen service account token Corporate Control: Kubernetes Authentication"| B
    A -->|"Attacker authenticates to the Kubernetes API server Corporate Control: Kubernetes API Server"| B
    A -->|"Foothold established by enumerating accessible namespaces Corporate Control: Kubernetes Namespace Logs"| B
    A -->|"Detection possible by monitoring unexpected API requests Corporate Control: Kubernetes Logs"| B
    B -->|"Prepare malicious API requests targeting critical cluster components Corporate Control: API Server Configuration"| C
    B -->|"Modify requests to bypass security policies Corporate Control: Kubernetes RBAC"| C
    B -->|"Avoid detection by mimicking legitimate API requests Corporate Control: API Monitoring"| C
    B -->|"Monitor for unauthorized namespace access Corporate Control: Kubernetes Security Tools"| C
    C -->|"Deploy workloads using API calls Corporate Control: Kubernetes Workloads"| D
    C -->|"Leverage elevated privileges to execute commands Corporate Control: Cluster Nodes"| D
    C -->|"Monitor for unusual workload creation Corporate Control: Kubernetes Activity Logs"| D
    C -->|"Detection possible via behavioral analysis of API traffic Corporate Control: SIEM Systems"| D
    D -->|"Execute commands within the Kubernetes cluster Corporate Control: Cluster Resources"| E
    D -->|"Achieve full control over cluster workloads Corporate Control: Cluster Nodes"| E
    D -->|"Monitor for anomalies in cluster activity Corporate Control: Kubernetes Monitoring Tools"| E
    D -->|"Execution achieves cluster compromise Corporate Control: Kubernetes Environment"| E
