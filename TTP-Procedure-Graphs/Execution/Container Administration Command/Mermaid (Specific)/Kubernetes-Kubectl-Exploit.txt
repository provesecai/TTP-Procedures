graph TD;
    A[Initial Foothold Gained]
    B[Prepare for Kubernetes Exploitation]
    C[Execute Malicious Kubectl Commands]
    D[Access Cluster Resources]
    E[Command Execution Achieved]

    A -->|"Access gained via stolen kubeconfig file Corporate Control: Developer Machine"| B
    A -->|"Attacker logs into Kubernetes cluster using compromised kubeconfig Corporate Control: Kubernetes API Server"| B
    A -->|"Foothold established by enumerating cluster resources Corporate Control: Cluster Logs"| B
    A -->|"Detection possible through monitoring API access Corporate Control: Kubernetes Logs"| B
    B -->|"Prepare kubectl commands to deploy malicious workloads Corporate Control: Command Line"| C
    B -->|"Disguise commands to look like normal admin activity Corporate Control: Cluster Management"| C
    B -->|"Ensure compatibility with cluster policies Corporate Control: Kubernetes RBAC"| C
    B -->|"Monitor for unusual kubectl commands Corporate Control: Kubernetes Security Tools"| C
    C -->|"Deploy malicious pod with elevated permissions Corporate Control: Kubernetes Cluster"| D
    C -->|"Pod executes commands to exfiltrate data Corporate Control: Cluster Nodes"| D
    C -->|"Avoid detection by mimicking legitimate pods Corporate Control: Security Monitoring Tools"| D
    C -->|"Monitor pod creation for anomalies Corporate Control: Kubernetes Monitoring"| D
    D -->|"Execute malicious commands within the cluster Corporate Control: Cluster Environment"| E
    D -->|"Achieve attacker objectives within the cluster Corporate Control: Target Infrastructure"| E
    D -->|"Monitor for unusual pod or container behavior Corporate Control: SIEM Tools"| E
    D -->|"Execution achieves cluster compromise Corporate Control: Kubernetes Nodes"| E
