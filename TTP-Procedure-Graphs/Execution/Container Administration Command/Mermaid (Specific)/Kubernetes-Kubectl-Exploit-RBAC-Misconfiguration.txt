graph TD;
    A[Initial Foothold Gained]
    B[Prepare for RBAC Exploitation]
    C[Deploy Malicious Pod with Elevated Privileges]
    D[Execute Commands in Privileged Pod]
    E[Execution Achieved]

    A -->|"Access gained via compromised kubeconfig file Corporate Control: Developer Machine"| B
    A -->|"Foothold established by authenticating to Kubernetes cluster Corporate Control: Kubernetes API Server"| B
    A -->|"Attacker enumerates RBAC permissions to identify elevated roles Corporate Control: Kubernetes RBAC"| B
    A -->|"Detection possible by monitoring RBAC policy changes Corporate Control: Kubernetes Logs"| B
    B -->|"Create malicious pod definition with elevated permissions Corporate Control: Kubernetes Pods"| C
    B -->|"Deploy pod to namespace with privileged access Corporate Control: Kubernetes Namespace"| C
    B -->|"Monitor for unauthorized pod creation activities Corporate Control: SIEM Systems"| C
    B -->|"Avoid detection by mimicking legitimate pod metadata Corporate Control: Kubernetes Security Tools"| C
    C -->|"Trigger pod to execute commands within elevated namespace Corporate Control: Kubernetes Cluster"| D
    C -->|"Leverage elevated role to manipulate cluster resources Corporate Control: Cluster Configuration"| D
    C -->|"Avoid detection by limiting resource usage Corporate Control: Monitoring Tools"| D
    C -->|"Monitor for anomalies in pod behavior Corporate Control: Kubernetes Monitoring Tools"| D
    D -->|"Achieve execution objectives within the cluster Corporate Control: Kubernetes Nodes"| E
    D -->|"Monitor for unauthorized resource access from the pod Corporate Control: Kubernetes Activity Logs"| E
    D -->|"Execution achieves control over critical cluster resources Corporate Control: Target Infrastructure"| E
    D -->|"Detection possible through detailed pod behavior analysis Corporate Control: SIEM Systems"| E
