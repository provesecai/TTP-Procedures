<graphml xmlns="http://graphml.graphdrawing.org/xmlns" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd">
<graph id="Exploiting_Citrix_Logon_Scripts" edgedefault="directed">
<!--  Nodes  -->
<node id="A">
<data key="label">Identify Citrix Logon Script Policies</data>
</node>
<node id="B">
<data key="label">Modify or Deploy Malicious Citrix Logon Scripts</data>
</node>
<node id="C">
<data key="label">Monitor and Maintain Citrix Logon Script Execution</data>
</node>
<node id="D">
<data key="label">Conceal Citrix Logon Script Modifications</data>
</node>
<node id="E">
<data key="label">Persistence Achieved via Citrix Logon Scripts</data>
</node>
<!--  Edges with Conditions/Weaknesses  -->
<edge source="A" target="B">
<data key="label">Locate Citrix user logon script configurations (Citrix Profile Management) Corporate Control: Citrix Group Policies</data>
</edge>
<edge source="A" target="B">
<data key="label">Identify administrators with permissions to modify Citrix logon scripts Corporate Control: Citrix Active Directory Roles</data>
</edge>
<edge source="A" target="B">
<data key="label">Prepare malicious PowerShell or Batch scripts for execution Corporate Control: Internal Citrix File Repository</data>
</edge>
<edge source="A" target="B">
<data key="label">Analyze logging mechanisms for Citrix profile modifications Corporate Control: Citrix Logon Events</data>
</edge>
<edge source="B" target="C">
<data key="label">Inject scripts into Citrix logon policies Corporate Control: Citrix Group Policy Editor</data>
</edge>
<edge source="B" target="C">
<data key="label">Ensure execution during Citrix user login sessions Corporate Control: Citrix Logon Process</data>
</edge>
<edge source="B" target="C">
<data key="label">Validate execution by testing with Citrix virtual desktop sessions Corporate Control: Citrix Session Logs</data>
</edge>
<edge source="B" target="C">
<data key="label">Apply obfuscation techniques (hidden execution, script encryption) Corporate Control: Citrix Configuration Manager</data>
</edge>
<edge source="C" target="D">
<data key="label">Monitor Citrix logon script execution for unauthorized changes Corporate Control: Citrix Event Logs</data>
</edge>
<edge source="C" target="D">
<data key="label">Ensure persistence across Citrix policy updates Corporate Control: Citrix Configuration Baselines</data>
</edge>
<edge source="C" target="D">
<data key="label">Validate stealth against Citrix security tools Corporate Control: Citrix Endpoint Security</data>
</edge>
<edge source="C" target="D">
<data key="label">Reconfigure Citrix logon script settings periodically Corporate Control: Citrix Profile Update Management</data>
</edge>
<edge source="D" target="E">
<data key="label">Remove logs of Citrix logon script modifications Corporate Control: Citrix Security Logs</data>
</edge>
<edge source="D" target="E">
<data key="label">Obfuscate script paths and configurations Corporate Control: File System Metadata</data>
</edge>
<edge source="D" target="E">
<data key="label">Blend malicious logon scripts with legitimate Citrix policies Corporate Control: Citrix System Policies</data>
</edge>
<edge source="D" target="E">
<data key="label">Continuously monitor Citrix user logon script execution Corporate Control: Security Operations Center</data>
</edge>
</graph>
</graphml>
