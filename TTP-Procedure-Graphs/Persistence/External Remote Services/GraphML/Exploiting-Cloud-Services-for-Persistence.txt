<graphml xmlns="http://graphml.graphdrawing.org/xmlns" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd">
<graph id="ExploitingCloudServicesForPersistence" edgedefault="directed">
<!--  Nodes  -->
<node id="A">
<data key="label">Prepare to Exploit Cloud Services for Persistent Access</data>
</node>
<node id="B">
<data key="label">Configure Cloud Services for Remote Access</data>
</node>
<node id="C">
<data key="label">Ensure Persistence Through Cloud Services</data>
</node>
<node id="D">
<data key="label">Conceal Cloud Access</data>
</node>
<node id="E">
<data key="label">Persistence Achieved via Cloud Services</data>
</node>
<!--  Edges with Conditions/Weaknesses  -->
<edge source="A" target="B">
<data key="label">Gain administrative access to cloud service accounts Corporate Control: Cloud Provider Admin Rights, API Access</data>
</edge>
<edge source="A" target="B">
<data key="label">Identify cloud services that allow external access (e.g., AWS, Azure) Corporate Control: Cloud Console Access</data>
</edge>
<edge source="A" target="B">
<data key="label">Configure cloud services to allow remote management Corporate Control: Cloud Console Configuration, Virtual Machines (VM)</data>
</edge>
<edge source="A" target="B">
<data key="label">Monitor for weaknesses in cloud access permissions Corporate Control: Cloud Access Logs, API Logs</data>
</edge>
<edge source="B" target="C">
<data key="label">Set up reverse shell or persistent VPN within the cloud service Corporate Control: Cloud Networking, VPN Configuration</data>
</edge>
<edge source="B" target="C">
<data key="label">Ensure persistent access via cloud infrastructure services (e.g., EC2, Azure VMs) Corporate Control: Cloud Management Console, API Access</data>
</edge>
<edge source="B" target="C">
<data key="label">Configure cloud resources to start automatically with system boot Corporate Control: Cloud VM Configuration, Auto-Scaling Settings</data>
</edge>
<edge source="B" target="C">
<data key="label">Ensure cloud access is persistent after reboots Corporate Control: Cloud Service Reconnection, Auto-Scaling Configuration</data>
</edge>
<edge source="C" target="D">
<data key="label">Monitor cloud resource access for signs of detection Corporate Control: Cloud SIEM, API Monitoring</data>
</edge>
<edge source="C" target="D">
<data key="label">Ensure access is undetected by automated security tools Corporate Control: Cloud Security Monitoring, EDR Solutions</data>
</edge>
<edge source="C" target="D">
<data key="label">Maintain cloud access by regularly checking configurations Corporate Control: Cloud Management Console, Log Management</data>
</edge>
<edge source="D" target="E">
<data key="label">Hide cloud access activities from admin access Corporate Control: Cloud Activity Logs, User Permissions</data>
</edge>
<edge source="D" target="E">
<data key="label">Blend cloud activity with legitimate user traffic Corporate Control: Cloud Network Traffic, Cloud Access Logs</data>
</edge>
<edge source="D" target="E">
<data key="label">Ensure cloud access remains undetected by security solutions Corporate Control: Antivirus, Cloud Security Monitoring</data>
</edge>
<edge source="D" target="E">
<data key="label">Monitor cloud logs for anomalies in access Corporate Control: SIEM Systems, SOC Monitoring</data>
</edge>
</graph>
</graphml>
