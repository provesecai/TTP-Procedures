<graphml xmlns="http://graphml.graphdrawing.org/xmlns" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd">
<graph id="Using_BITS_Job_Notifications" edgedefault="directed">
<!--  Nodes  -->
<node id="A">
<data key="label">Identify BITS Job Notification Features</data>
</node>
<node id="B">
<data key="label">Configure Malicious Notifications</data>
</node>
<node id="C">
<data key="label">Monitor and Maintain Notifications</data>
</node>
<node id="D">
<data key="label">Conceal Notification Configurations</data>
</node>
<node id="E">
<data key="label">Persistence Achieved via BITS Job Notifications</data>
</node>
<!--  Edges  -->
<edge source="A" target="B">
<data key="label">List available BITS jobs supporting notifications Corporate Control: Windows Task Scheduler</data>
</edge>
<edge source="A" target="B">
<data key="label">Identify systems configured for BITS job notifications Corporate Control: BITS Administration</data>
</edge>
<edge source="A" target="B">
<data key="label">Analyze permissions required to modify notifications Corporate Control: Active Directory Roles</data>
</edge>
<edge source="A" target="B">
<data key="label">Assess logging and alerting for notification events Corporate Control: Event Viewer</data>
</edge>
<edge source="B" target="C">
<data key="label">Configure notifications to trigger malicious scripts Corporate Control: BITS API</data>
</edge>
<edge source="B" target="C">
<data key="label">Insert scripts into notification triggers Corporate Control: Internal File Servers</data>
</edge>
<edge source="B" target="C">
<data key="label">Validate notification execution through testing Corporate Control: System Logs</data>
</edge>
<edge source="B" target="C">
<data key="label">Ensure notifications persist across reboots Corporate Control: Notification System Configuration</data>
</edge>
<edge source="C" target="D">
<data key="label">Monitor notification activity for anomalies Corporate Control: Windows Event Logs</data>
</edge>
<edge source="C" target="D">
<data key="label">Revalidate notification triggers periodically Corporate Control: System Maintenance Tools</data>
</edge>
<edge source="C" target="D">
<data key="label">Ensure stealth in scripts or payloads triggered Corporate Control: Security Operations</data>
</edge>
<edge source="C" target="D">
<data key="label">Test notifications against detection mechanisms Corporate Control: Endpoint Detection Tools</data>
</edge>
<edge source="D" target="E">
<data key="label">Mask notification configurations in logs Corporate Control: Event Viewer</data>
</edge>
<edge source="D" target="E">
<data key="label">Ensure scripts blend with legitimate activity Corporate Control: Notification Metadata</data>
</edge>
<edge source="D" target="E">
<data key="label">Monitor notification systems for signs of detection Corporate Control: Security Monitoring Systems</data>
</edge>
<edge source="D" target="E">
<data key="label">Adapt configurations to evade future detection Corporate Control: Task Scheduler</data>
</edge>
</graph>
</graphml>
