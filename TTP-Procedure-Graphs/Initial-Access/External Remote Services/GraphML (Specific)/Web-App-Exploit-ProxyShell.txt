<graphml xmlns="http://graphml.graphdrawing.org/xmlns" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd">
<graph id="Web-App-Exploit-ProxyShell" edgedefault="directed">
<!--  Nodes  -->
<node id="A">
<data key="label">Identify Vulnerable Exchange Server</data>
</node>
<node id="B">
<data key="label">Exploit ProxyShell Vulnerabilities</data>
</node>
<node id="C">
<data key="label">Upload Malicious Web Shell</data>
</node>
<node id="D">
<data key="label">Execute Malicious Commands</data>
</node>
<node id="E">
<data key="label">Initial Access Achieved</data>
</node>
<!--  Edges with Conditions/Weaknesses  -->
<edge source="A" target="B">
<data key="label">Scan for Exchange servers with known ProxyShell vulnerabilities Corporate Control: Public-Facing Server</data>
</edge>
<edge source="A" target="B">
<data key="label">Focus on outdated Exchange versions Corporate Control: Exchange Configuration</data>
</edge>
<edge source="A" target="B">
<data key="label">Gather intelligence on server configurations Corporate Control: Mail Server</data>
</edge>
<edge source="A" target="B">
<data key="label">Minimize detection by blending with normal traffic Corporate Control: IDS Logs</data>
</edge>
<edge source="B" target="C">
<data key="label">Send crafted requests to exploit CVE-2021-34473 Corporate Control: Exchange Service</data>
</edge>
<edge source="B" target="C">
<data key="label">Bypass authentication using CVE-2021-34523 Corporate Control: Autodiscover Service</data>
</edge>
<edge source="B" target="C">
<data key="label">Trigger arbitrary code execution via CVE-2021-31207 Corporate Control: Mail Server</data>
</edge>
<edge source="B" target="C">
<data key="label">Avoid detection by using encrypted payloads Corporate Control: Network Logs</data>
</edge>
<edge source="C" target="D">
<data key="label">Upload malicious web shell to server Corporate Control: Exchange Filesystem</data>
</edge>
<edge source="C" target="D">
<data key="label">Ensure web shell persistence for ongoing access Corporate Control: Server Configuration</data>
</edge>
<edge source="C" target="D">
<data key="label">Monitor for system-level detection Corporate Control: Exchange Logs</data>
</edge>
<edge source="C" target="D">
<data key="label">Test access through web shell Corporate Control: Web Application</data>
</edge>
<edge source="D" target="E">
<data key="label">Execute arbitrary commands via web shell Corporate Control: Mail Server</data>
</edge>
<edge source="D" target="E">
<data key="label">Initial access achieved through Exchange exploitation Corporate Control: Internal Network</data>
</edge>
<edge source="D" target="E">
<data key="label">Prepare for lateral movement Corporate Control: Network Systems</data>
</edge>
<edge source="D" target="E">
<data key="label">Avoid detection by obfuscating activity Corporate Control: Security Monitoring</data>
</edge>
</graph>
</graphml>
