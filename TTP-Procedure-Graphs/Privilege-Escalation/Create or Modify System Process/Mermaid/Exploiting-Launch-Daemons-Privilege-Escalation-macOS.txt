graph TD;
    A[Obtain Low-Level Access]
    B[Create Malicious LaunchDaemon]
    C[Enable and Start LaunchDaemon]
    D[Evade Detection of LaunchDaemon Modification]
    E[Root Privileges Achieved]

    A -->|"Gain access to a standard macOS user account Corporate Control: macOS User Account Management"| B
    A -->|"Identify permissions to create new LaunchDaemon Corporate Control: macOS File System Security"| B
    A -->|"Assess system configurations for daemon execution Corporate Control: macOS LaunchDaemon Configuration"| B
    A -->|"Monitor for unauthorized LaunchDaemon creations Corporate Control: SIEM, macOS System Logs"| B
    B -->|"Create a new LaunchDaemon file in '/Library/LaunchDaemons/' pointing to a malicious script Corporate Control: macOS System Configuration"| C
    B -->|"Ensure daemon executes with root privileges Corporate Control: macOS System Integrity Protection (SIP)"| C
    B -->|"Modify service attributes to maintain persistence Corporate Control: Unix Access Control Lists (ACLs)"| C
    B -->|"Monitor for unauthorized LaunchDaemon modifications Corporate Control: Endpoint Detection and Response (EDR)"| C
    C -->|"Enable and start the malicious LaunchDaemon Corporate Control: macOS Launchd Service Manager"| D
    C -->|"Confirm root privileges by executing administrative commands Corporate Control: User Privilege Validation"| D
    C -->|"Ensure service remains active after reboot Corporate Control: macOS Boot Policies"| D
    C -->|"Monitor for unauthorized privilege escalations via LaunchDaemons Corporate Control: SIEM, Threat Intelligence Feeds"| D
    D -->|"Modify system logs to remove traces of LaunchDaemon creation Corporate Control: Log Scrubbing, macOS Security Logs"| E
    D -->|"Deploy additional privilege escalation vectors for redundancy Corporate Control: Alternate macOS LaunchDaemon Exploitation Techniques"| E
    D -->|"Ensure continued root access by modifying execution policies Corporate Control: macOS Security Policy Management"| E
    D -->|"SOC continuously monitors for unauthorized LaunchDaemon modifications Corporate Control: Security Operations Center (SOC)"| E
