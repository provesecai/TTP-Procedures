<graphml xmlns="http://graphml.graphdrawing.org/xmlns" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd">
<graph id="Windows-Service-Path-Exploitation" edgedefault="directed">
<!--  Nodes  -->
<node id="A">
<data key="label">Identify Services with Weak Path Permissions</data>
</node>
<node id="B">
<data key="label">Modify Service Executable Path</data>
</node>
<node id="C">
<data key="label">Validate SYSTEM-Level Privileges</data>
</node>
<node id="D">
<data key="label">Conceal Service Exploitation</data>
</node>
<node id="E">
<data key="label">SYSTEM Privileges Achieved</data>
</node>
<!--  Edges with Conditions  -->
<edge source="A" target="B">
<data key="label">Enumerate Windows services with weak permissions using 'sc qc' Corporate Control: Windows Service Management</data>
</edge>
<edge source="A" target="B">
<data key="label">Identify writable directories in service paths Corporate Control: NTFS Access Control Lists (ACLs)</data>
</edge>
<edge source="A" target="B">
<data key="label">Determine if service restart triggers privilege escalation Corporate Control: Windows Service Hardening Policies</data>
</edge>
<edge source="A" target="B">
<data key="label">Monitor for unauthorized changes to service configurations Corporate Control: SIEM, Windows Event Logs</data>
</edge>
<edge source="B" target="C">
<data key="label">Replace service binary or modify ImagePath registry entry Corporate Control: Windows Registry Configuration</data>
</edge>
<edge source="B" target="C">
<data key="label">Leverage weak permission service executable overwrites Corporate Control: File System Integrity Policies</data>
</edge>
<edge source="B" target="C">
<data key="label">Ensure modified service executes with SYSTEM privileges Corporate Control: Windows Service Control Manager (SCM)</data>
</edge>
<edge source="B" target="C">
<data key="label">Monitor for abnormal service restarts Corporate Control: Endpoint Detection and Response (EDR)</data>
</edge>
<edge source="C" target="D">
<data key="label">Validate SYSTEM access by executing privileged commands Corporate Control: User Privilege Validation Logs</data>
</edge>
<edge source="C" target="D">
<data key="label">Ensure ability to modify protected system settings Corporate Control: Windows Group Policy Enforcement</data>
</edge>
<edge source="C" target="D">
<data key="label">Maintain elevated session across reboots Corporate Control: System Boot Configuration</data>
</edge>
<edge source="C" target="D">
<data key="label">Detect unauthorized service execution attempts Corporate Control: SIEM, Behavioral Analytics</data>
</edge>
<edge source="D" target="E">
<data key="label">Modify service logs to remove traces of exploitation Corporate Control: Event Viewer Log Manipulation</data>
</edge>
<edge source="D" target="E">
<data key="label">Deploy persistence techniques (e.g., new registry entries, scheduled tasks) Corporate Control: Windows Task Scheduler</data>
</edge>
<edge source="D" target="E">
<data key="label">Prevent service recovery mechanisms from revoking SYSTEM privileges Corporate Control: Windows Security Auditing</data>
</edge>
<edge source="D" target="E">
<data key="label">SOC continuously monitors Windows service modifications Corporate Control: Security Operations Center (SOC)</data>
</edge>
</graph>
</graphml>
